<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>東寧教會點名系統</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
  <header class="header">
    <h1>東寧教會點名系統</h1>
  </header>

  <main>
    <section class="input-section">
      <input type="text" id="newName" placeholder="輸入名字..." />
      <button class="btn btn-primary" onclick="addName()">新增名字</button>
      <input type="file" id="fileInput" accept=".docx, .xlsx" onchange="handleFileUpload(event)" />
    </section>

    <section class="search-section">
      <input class="search-box" type="text" placeholder="搜尋名字..." oninput="filterNames()" />
    </section>

    <section class="table-section">
      <table class="table" id="nameTable">
        <thead>
          <tr>
            <th>名字</th>
            <th>操作</th>
            <th>刪除</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section class="stats-section">
      <h3>點名統計</h3>
      <p>出席: <span id="presentCount">0</span></p>
      <p>請假: <span id="absentCount">0</span></p>
      <p>未到: <span id="leaveCount">0</span></p>
      <p>出席率: <span id="attendanceRate">0.00%</span></p>
      <button class="btn btn-secondary" onclick="exportToExcel()">匯出成 Excel</button>
    </section>

    <!-- 將總刪除所有名單按鈕移至右側 -->
    <div style="text-align: right; margin-top: 20px;">
      <button class="btn btn-danger" onclick="clearAll()">刪除所有名單</button>
    </div>
  </main>

  <script src="script.js"></script>
</body>
</html>
